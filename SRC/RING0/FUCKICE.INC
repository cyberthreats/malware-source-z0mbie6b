
; [ring-0]

fuckice:                pusha

                        push    ebx
                        sidt    [esp-2]
                        pop     ebx

                        mov     eax, [ebx+01h*8+6-2]      ; int 01h
                        mov     ax, [ebx+01h*8+0]
                        call    fuckint

                        mov     eax, [ebx+03h*8+6-2]      ; int 03h
                        mov     ax, [ebx+03h*8+0]
                        call    fuckint

                        popa
                        ret

fuckint:                cmp     byte ptr [eax], 68h     ; softice signature
                        jne     __skipfuck
                        cmp     byte ptr [eax+5], 0E9h  ; -//-
                        jne     __skipfuck
                        mov     byte ptr [eax], 0CFh ; iret
__skipfuck:             ret
